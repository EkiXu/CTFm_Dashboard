(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["app"],{0:function(e,t,n){e.exports=n("56d7")},"21bb":function(e,t,n){"use strict";n("2dad")},"2dad":function(e,t,n){},4360:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n("2b0e"),r=n("2f62"),o=n("bfa9"),c=(n("96cf"),n("1da1")),s=n("5530"),i=n("b775"),u=function(e){return Object(i["a"])({url:"/auth/obtain_token/",method:"post",data:e})},l=function(e){return Object(i["a"])({url:"/auth/refresh_token/",method:"post",data:e})},m=n("a18c"),f=n("1232"),h={namespaced:!0,state:{accessToken:localStorage.getItem("accessToken"),refreshToken:localStorage.getItem("refreshToken"),userInfo:{id:0,nickname:"",username:""}},mutations:{updateTokens:function(e,t){localStorage.setItem("accessToken",t.access),e.accessToken=t.access,localStorage.setItem("refreshToken",t.refresh),e.refreshToken=t.refresh},updateAccessToken:function(e,t){localStorage.setItem("accessToken",t),e.accessToken=t},removeAccessToken:function(e){localStorage.removeItem("accessToken"),e.accessToken=null},removeTokens:function(e){localStorage.removeItem("accessToken"),e.accessToken=null,localStorage.removeItem("refreshToken"),e.refreshToken=null},setUserInfo:function(e,t){e.userInfo=t},resetUserInfo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.userInfo=Object(s["a"])(Object(s["a"])({},e.userInfo),t)}},actions:{ObtainToken:function(e,t){return Object(c["a"])(regeneratorRuntime.mark((function n(){var a,r,o,c,s,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.commit,n.next=3,u(t);case 3:if(r=n.sent,200!=r.status){n.next=14;break}if(o={access:r.data.access,refresh:r.data.refresh},a("updateTokens",o),c=Object(f["a"])(r.data.access),c.is_staff){n.next=10;break}throw Error("Forrbidden");case 10:s={nickname:c.nickname,username:c.username,id:c.id,is_hidden:c.is_hidden,is_staff:c.is_staff},a("setUserInfo",s),i=m["a"].history.current.query.redirect,i?m["a"].push({path:i}):m["a"].push({path:"/contest"});case 14:return n.abrupt("return",r);case 15:case"end":return n.stop()}}),n)})))()},RefreshToken:function(e,t){return Object(c["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.commit,n.next=3,l({refresh:t});case 3:return r=n.sent,console.log(r),200==r.status&&a("updateAccessToken",r.data.access),n.abrupt("return",r);case 7:case"end":return n.stop()}}),n)})))()},UpdateUserInfo:function(e,t){var n=e.commit;n("resetUserInfo",t)},ClearUserState:function(e){var t=e.commit;t("resetUserInfo",{}),t("removeTokens")},Logout:function(e){var t=e.commit;t("removeTokens");var n={nickname:null,username:null};t("setUserInfo",n),m["a"].push({path:"/login"})}},getters:{userInfo:function(e){return e.userInfo},accessToken:function(e){return e.accessToken},refreshToken:function(e){return e.refreshToken}}};a["a"].use(r["a"]);var d=new o["a"]({storage:window.localStorage,modules:["user"]}),p=new r["a"].Store({modules:{user:h},plugins:[d.plugin]})},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-app",{attrs:{id:"app"}},[n("NavMenu"),n("v-main",{staticClass:"main"},[n("router-view")],1)],1)},o=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-app-bar",{staticClass:"nav",attrs:{app:"",height:"56px","elevate-on-scroll":""}},[n("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),n("v-toolbar-title",{staticClass:"toolbar-title"}),n("v-spacer"),null===e.accessToken?[n("v-btn",{attrs:{text:"",to:"/login"}},[e._v(" Login ")])]:[n("v-menu",{attrs:{left:"","open-on-hover":"",bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on,r=t.attrs;return[n("v-btn",e._g(e._b({staticStyle:{"text-transform":"unset"},attrs:{text:""}},"v-btn",r,!1),a),[e._v(" "+e._s(e.userInfo.nickname)+" ")])]}}])},[n("v-list",[n("v-list-item",{attrs:{link:"",to:"/profile"}},[n("v-list-item-title",[e._v("Profile")])],1),n("v-list-item",{on:{click:e.Logout}},[n("v-list-item-title",[e._v("Logout")])],1)],1)],1)]],2),n("v-navigation-drawer",{staticClass:"drawer",attrs:{app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[n("router-link",{attrs:{to:"/"}},[n("div",{staticClass:"drawer_header"},[n("h1",{staticClass:"font-weight-light"},[e._v(" CTFm Dashboard ")])])]),n("v-list",e._l(e.menu,(function(t){return n("v-list-item",{key:t.name,attrs:{link:"",to:t.href}},[n("v-list-item-action",[n("v-icon",[e._v(e._s(t.icon))])],1),n("v-list-item-content",[n("v-list-item-title",[e._v(e._s(t.name))])],1)],1)})),1)],1)],1)},s=[],i=(n("b0c0"),n("5530")),u=n("2f62"),l={name:"NavMenu",props:{source:String},data:function(){return{drawer:null,dropdown_menu:["Profile","Logout"],isLoggedIn:!1,menu:[{name:"Contest",href:"/contest",icon:"mdi-sword-cross"},{name:"Category",href:"/category",icon:"mdi-tag"},{name:"Challenge",href:"/challenge",icon:"mdi-flag"},{name:"Notification",href:"/notification",icon:"mdi-bell"},{name:"User",href:"/user",icon:"mdi-account-supervisor"},{name:"Team",href:"/team",icon:"mdi-account-group"},{name:"Container",href:"/container",icon:"mdi-animation"},{name:"Whale",href:"/whale",icon:"mdi-docker"}]}},computed:Object(i["a"])({},Object(u["c"])("user",["accessToken","userInfo"])),created:function(){},methods:Object(i["a"])(Object(i["a"])({},Object(u["b"])("user",["Logout"])),{},{isHome:function(e){return"home"===e.name}})},m=l,f=(n("a01c"),n("2877")),h=n("6544"),d=n.n(h),p=n("40dc"),b=n("5bc1"),k=n("8336"),v=n("132d"),g=n("8860"),T=n("da13"),w=n("1800"),I=n("5d23"),_=n("e449"),C=n("f774"),y=n("2fa4"),O=n("2a7f"),P=Object(f["a"])(m,c,s,!1,null,null,null),S=P.exports;d()(P,{VAppBar:p["a"],VAppBarNavIcon:b["a"],VBtn:k["a"],VIcon:v["a"],VList:g["a"],VListItem:T["a"],VListItemAction:w["a"],VListItemContent:I["a"],VListItemTitle:I["b"],VMenu:_["a"],VNavigationDrawer:C["a"],VSpacer:y["a"],VToolbarTitle:O["a"]});var j={name:"App",components:{NavMenu:S},data:function(){return{drawer:null}},created:function(){this.$vuetify.theme.dark=!0}},x=j,V=(n("5c0b"),n("7496")),L=n("f6c4"),U=Object(f["a"])(x,r,o,!1,null,null,null),N=U.exports;d()(U,{VApp:V["a"],VMain:L["a"]});var A=n("a18c"),R=n("4360"),$=n("f309");a["a"].use($["a"]);var E=new $["a"]({theme:{themes:{dark:{primary:"#00bcd4",secondary:"#b0bec5",accent:"#8c9eff",error:"#ff5252"}}}});n("4633");a["a"].use(n("84b5"));var D=n("98c9");a["a"].use(D["a"]);var F=n("9ce6"),M=n.n(F);a["a"].component("vue-markdown",M.a);var B=n("6838"),q=n.n(B);a["a"].use(q.a,{hideProgressbar:!0,position:"bottom-left"}),a["a"].config.productionTip=!1,new a["a"]({router:A["a"],store:R["a"],vuetify:E,render:function(e){return e(N)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";n("9c0c")},"5fbe":function(e,t,n){e.exports=n.p+"static/img/logo2.62ca6d84.png"},"9c0c":function(e,t,n){},a01c:function(e,t,n){"use strict";n("fa16")},a18c:function(e,t,n){"use strict";n("d3b7");var a=n("2b0e"),r=n("8c4f"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{staticClass:"home"},[a("div",{staticClass:"logo"},[a("img",{attrs:{alt:"CTFm logo",src:n("5fbe")}})]),a("h1",[e._v("Welcome to CTFm Dashboard")])])},c=[],s={name:"Home",components:{}},i=s,u=(n("21bb"),n("2877")),l=n("6544"),m=n.n(l),f=n("a523"),h=Object(u["a"])(i,o,c,!1,null,null,null),d=h.exports;m()(h,{VContainer:f["a"]});var p=r["a"].prototype.push;r["a"].prototype.push=function(e){return p.call(this,e)["catch"]((function(e){return e}))},a["a"].use(r["a"]);var b=[{path:"/",name:"home",component:d,meta:{title:"Home"}},{path:"/login",name:"login",component:function(){return Promise.all([n.e("chunk-abcd3028"),n.e("chunk-206136ba")]).then(n.bind(null,"a55b"))},meta:{title:"Login"}},{path:"/notification",name:"notification",component:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-abcd3028"),n.e("chunk-7c8379b9"),n.e("chunk-06f436d7"),n.e("chunk-2d0aa29d")]).then(n.bind(null,"109a"))},meta:{title:"Notifications"}},{path:"/profile",component:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-abcd3028"),n.e("chunk-08fbae94")]).then(n.bind(null,"c66d"))},name:"profile",meta:{title:"Profile"}},{path:"/category",component:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-abcd3028"),n.e("chunk-7c8379b9"),n.e("chunk-fc3689ee"),n.e("chunk-650a77cb")]).then(n.bind(null,"4886"))},name:"category",meta:{title:"Category"}},{path:"/challenge",component:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-abcd3028"),n.e("chunk-7c8379b9"),n.e("chunk-06f436d7"),n.e("chunk-73c4326a")]).then(n.bind(null,"98ed"))},name:"challenge",meta:{title:"Challenge"}},{path:"/user",component:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-abcd3028"),n.e("chunk-7c8379b9"),n.e("chunk-80f2ca74")]).then(n.bind(null,"1511"))},name:"user",meta:{title:"Page"}},{path:"/contest",component:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-abcd3028"),n.e("chunk-06f436d7"),n.e("chunk-fc3689ee"),n.e("chunk-60b98906")]).then(n.bind(null,"9169"))},name:"contest",meta:{title:"Contest"}},{path:"/team",component:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-abcd3028"),n.e("chunk-7c8379b9"),n.e("chunk-06f436d7"),n.e("chunk-e61bccaa")]).then(n.bind(null,"0767"))},name:"team",meta:{title:"Team"}},{path:"/container",component:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-abcd3028"),n.e("chunk-7c8379b9"),n.e("chunk-06f436d7"),n.e("chunk-2d0cc471")]).then(n.bind(null,"4cf2"))},name:"container",meta:{title:"Container"}},{path:"/whale",component:function(){return Promise.all([n.e("chunk-commons"),n.e("chunk-abcd3028"),n.e("chunk-35efa6c0")]).then(n.bind(null,"6458"))},name:"whale",meta:{title:"Whale"}},{path:"/error/404",name:"404 NOT FOUND",component:function(){return Promise.all([n.e("chunk-a7095c64"),n.e("chunk-bb5922cc")]).then(n.bind(null,"d80f"))},meta:{title:""}},{path:"*",redirect:"/error/404"}],k=new r["a"]({mode:"hash",base:"/admin/",routes:b});t["a"]=k},b775:function(e,t,n){"use strict";n("caad"),n("c975"),n("6eba"),n("0d03"),n("d3b7"),n("25f0"),n("2532"),n("2ca0");var a=n("bc3a"),r=n.n(a),o=n("4360"),c=n("323e"),s=n.n(c),i=(n("a5d8"),n("2b0e")),u=n("1232"),l=n("a18c"),m=r.a.create({baseURL:"/api/v1",timeout:5e4});function f(){l["a"].push({path:"/login",query:{redirect:l["a"].currentRoute.fullPath}})}function h(){var e=o["a"].getters["user/accessToken"],t=Object(u["a"])(e),n=t.exp;if(n){var a=n-Date.now()/1e3<1800;return a}return!1}function d(){var e=o["a"].getters["user/refreshToken"],t=Object(u["a"])(e),n=t.exp;if(n){var a=n-Date.now()/1e3<0;return a}return!1}window.isRefreshing=!1,m.interceptors.request.use((function(e){if(s.a.start(),e.headers["Content-Type"]||(e.headers={"Content-Type":"application/json"}),e.url.startsWith("/auth"))return e;var t=o["a"].getters["user/accessToken"];if(t){var n=o["a"].getters["user/refreshToken"];if(d())o["a"].dispatch("user/ClearUserState");else{if(!h())return e.headers.Authorization="Bearer ".concat(t),e;o["a"].dispatch("user/RefreshToken",n)}}else f(),i["a"].$vToastify.error("Please Login First");return e}),(function(e){if(s.a.done(),"ECONNABORTED"===e.code&&-1!==e.message.indexOf("timeout")){i["a"].$vToastify.error("Sorry Timeout!");var t=e.config;return instance.request(t)}var n=e.response.data.detail;if(i["a"].$vToastify.error("Error: ".concat(n)),console.log(n),n){var a=n.status;l["a"].push({path:"/error/".concat(a)})}return Promise.reject(e)})),m.interceptors.response.use((function(e){return s.a.done(),e}),(function(e){if(s.a.done(),e.toString().includes("timeout"))e.message="Sorry Timeout！";else if(e.response)if(401==e.response.status||403==e.response.status)e.message="Forbidden",o["a"].dispatch("user/ClearUserState"),f();else if(e.response.data.detail)e.message=e.response.data.detail;else{var t;for(var n in e.response.data)t=n.toString()+e.response.data[n][0];e.message=t}return i["a"].$vToastify.error("Msg: ".concat(e.message)),console.error("Error： ".concat(e)),Promise.reject(e)})),t["a"]=m},fa16:function(e,t,n){}},[[0,"runtime","chunk-libs"]]]);